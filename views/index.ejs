<% layout('layout') -%>

<div class="max-w-3xl mx-auto">
    <div class="flex justify-between items-center mb-6">
        <h2 class="text-2xl font-bold text-gray-800">All Chats</h2>
        <a href="/chats/new" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition">
            New Chat
        </a>
    </div>

    <div class="space-y-4">
        <% for(let chat of chats) { %>
            <div class="bg-white rounded-lg shadow-md p-4 hover:shadow-lg transition">
                <div class="flex justify-between items-start">
                    <div>
                        <p class="text-sm text-gray-600">From: <span class="font-semibold"><%= chat.from %></span></p>
                        <p class="mt-2 text-gray-800"><%= chat.msg %></p>
                        <p class="mt-2 text-sm text-gray-600">To: <span class="font-semibold"><%= chat.to %></span></p>
                    </div>
                    <div class="flex space-x-2">
                        <a href="/chats/<%= chat._id %>/edit" class="text-blue-600 hover:text-blue-800">Edit</a>
                        <form action="/chats/<%= chat._id %>?_method=DELETE" method="POST">
                            <button type="submit" class="text-red-600 hover:text-red-800" 
                                    onclick="return confirm('Are you sure you want to delete this chat?')">
                                Delete
                            </button>
                        </form>
                    </div>
                </div>
                <div class="mt-2 text-xs text-gray-500">
                    <p><%= chat.created_at.toLocaleTimeString() %></p>
                    <p><%= chat.created_at.toLocaleDateString() %></p>
                </div>
            </div>
        <% } %>
    </div>
</div>